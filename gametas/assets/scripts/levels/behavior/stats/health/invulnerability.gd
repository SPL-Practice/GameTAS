extends "res://assets/scripts/levels/behavior/stats/health/vulnerability.gd"

onready var spare = $invulnerability
onready var sanity = $sanity

func boost_spare_time(bonus):
	spare.wait_time *= bonus
	
func boost_sanity_time(bonus):
	sanity.wait_time = 1.0 + bonus * 0.5
	
func boost_drop(bonus):
	drop = max(drop + bonus, 0);

var constant = 0
var drop = 1

func _on_invulnerability_timeout():
	spare.stop()
	if constant > 0 and value > 0:
		damage(constant)

func _on_sanity_timeout():
	if value > 0:
		sap(drop)
		sanity.start()

func damage(amount):
	if spare.is_stopped():
		spare.start()
		.damage(amount)

func release_damage(amount):
	constant -= amount

func hold_damage(amount):
	constant += amount
	damage(amount)
