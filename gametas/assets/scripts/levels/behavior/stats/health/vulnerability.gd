extends "res://assets/scripts/levels/behavior/stats/value/stat.gd"

signal damage()
signal heal()
signal killed()

var maximum: int = 1

func _set_maximum(value):
	maximum = value
	max_heal()
	
func is_killed():
	return value == 0

func sap(amount):
	_set_value(value - amount)

func damage(amount):
	sap(amount)
	emit_signal("damage")

func heal(amount):
	_set_value(value + amount)
	emit_signal("heal")

func max_heal():
	_compare_health(maximum)


func _set_value(next):
	_compare_health(clamp(next, 0, maximum))

func _compare_health(next):
	
	if next != value:
		._set_value(next)
		emit_signal("value_updated", value)
		if (is_killed()):
			emit_signal("killed")
