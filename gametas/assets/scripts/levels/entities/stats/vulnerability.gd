extends "res://assets/scripts/levels/entities/stats/stat.gd"

signal health_updated(value)
signal max_health_updated(value)
signal killed()

export (int) var max_health = 1 setget _set_max_hp

func _ready():
	value = max_health

func damage(amount):
	value -= amount

func heal(value):
	value += value

func max_heal(value):
	value = max_health

func is_killed():
	return value == 0

func _set_max_hp(next):
	max_health = next
	emit_signal("max_health_updated", max_health)
	value = max_health

func _set_value(value):
	_compare_health(clamp(value, 0, max_health))

func _compare_health(next):
	if value != next:
		._set_value(next)
		emit_signal("health_updated", value)
		if (is_killed()):
			emit_signal("killed")
